{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Svnak\\\\Desktop\\\\cr\\\\omegle-clone\\\\client\\\\src\\\\App.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const ws = useRef(null);\n  const pc = useRef(null);\n  const localVideo = useRef();\n  const remoteVideo = useRef();\n  useEffect(() => {\n    ws.current = new WebSocket('ws://localhost:8080');\n    ws.current.onmessage = async event => {\n      const data = JSON.parse(event.data);\n      if (data.type === 'info') {\n        setMessages(prev => [...prev, `ğŸ›ˆ ${data.message}`]);\n      } else if (data.type === 'message') {\n        setMessages(prev => [...prev, `Stranger: ${data.message}`]);\n      } else if (data.type === 'match') {\n        await startPeer(true);\n      } else if (data.type === 'offer') {\n        await startPeer(false, data.offer);\n      } else if (data.type === 'answer') {\n        await pc.current.setRemoteDescription(data.answer);\n      } else if (data.type === 'candidate') {\n        await pc.current.addIceCandidate(data.candidate);\n      }\n    };\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(stream => {\n      localVideo.current.srcObject = stream;\n    });\n    return () => {\n      ws.current.close();\n    };\n  }, []);\n  const startPeer = async (initiator = true, remoteOffer = null) => {\n    pc.current = new RTCPeerConnection();\n    pc.current.onicecandidate = e => {\n      if (e.candidate) {\n        ws.current.send(JSON.stringify({\n          type: 'candidate',\n          candidate: e.candidate\n        }));\n      }\n    };\n    pc.current.ontrack = e => {\n      remoteVideo.current.srcObject = e.streams[0];\n    };\n    const stream = localVideo.current.srcObject;\n    stream.getTracks().forEach(track => pc.current.addTrack(track, stream));\n    if (initiator) {\n      const offer = await pc.current.createOffer();\n      await pc.current.setLocalDescription(offer);\n      ws.current.send(JSON.stringify({\n        type: 'offer',\n        offer\n      }));\n    } else {\n      await pc.current.setRemoteDescription(remoteOffer);\n      const answer = await pc.current.createAnswer();\n      await pc.current.setLocalDescription(answer);\n      ws.current.send(JSON.stringify({\n        type: 'answer',\n        answer\n      }));\n    }\n  };\n  const sendMessage = () => {\n    if (input.trim() !== '') {\n      ws.current.send(JSON.stringify({\n        type: 'text',\n        text: input\n      }));\n      setMessages(prev => [...prev, `You: ${input}`]);\n      setInput('');\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter') sendMessage();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: '10px',\n        margin: '20px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: localVideo,\n        autoPlay: true,\n        muted: true,\n        style: {\n          width: '300px',\n          height: '200px',\n          background: 'black'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: remoteVideo,\n        autoPlay: true,\n        style: {\n          width: '300px',\n          height: '200px',\n          background: 'black'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: '400px',\n        height: '200px',\n        overflowY: 'auto',\n        border: '1px solid #ccc',\n        marginBottom: '10px',\n        padding: '10px'\n      },\n      children: messages.map((msg, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: msg\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 37\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: input,\n        onChange: e => setInput(e.target.value),\n        onKeyPress: handleKeyPress,\n        placeholder: \"Type a message...\",\n        style: {\n          padding: '10px',\n          width: '300px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: sendMessage,\n        style: {\n          padding: '10px'\n        },\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"FZSnF1eunYaEJ5tIp4IwaX3VB88=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["useEffect","useRef","useState","jsxDEV","_jsxDEV","App","_s","messages","setMessages","input","setInput","ws","pc","localVideo","remoteVideo","current","WebSocket","onmessage","event","data","JSON","parse","type","prev","message","startPeer","offer","setRemoteDescription","answer","addIceCandidate","candidate","navigator","mediaDevices","getUserMedia","video","audio","then","stream","srcObject","close","initiator","remoteOffer","RTCPeerConnection","onicecandidate","e","send","stringify","ontrack","streams","getTracks","forEach","track","addTrack","createOffer","setLocalDescription","createAnswer","sendMessage","trim","text","handleKeyPress","key","style","display","flexDirection","alignItems","children","gap","margin","ref","autoPlay","muted","width","height","background","fileName","_jsxFileName","lineNumber","columnNumber","overflowY","border","marginBottom","padding","map","msg","idx","value","onChange","target","onKeyPress","placeholder","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Svnak/Desktop/cr/omegle-clone/client/src/App.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\n\nfunction App() {\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const ws = useRef(null);\n  const pc = useRef(null);\n  const localVideo = useRef();\n  const remoteVideo = useRef();\n\n  useEffect(() => {\n    ws.current = new WebSocket('ws://localhost:8080');\n\n    ws.current.onmessage = async (event) => {\n      const data = JSON.parse(event.data);\n      \n      if (data.type === 'info') {\n        setMessages((prev) => [...prev, `ğŸ›ˆ ${data.message}`]);\n      } else if (data.type === 'message') {\n        setMessages((prev) => [...prev, `Stranger: ${data.message}`]);\n      } else if (data.type === 'match') {\n        await startPeer(true);\n      } else if (data.type === 'offer') {\n        await startPeer(false, data.offer);\n      } else if (data.type === 'answer') {\n        await pc.current.setRemoteDescription(data.answer);\n      } else if (data.type === 'candidate') {\n        await pc.current.addIceCandidate(data.candidate);\n      }\n    };\n\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n      .then(stream => {\n        localVideo.current.srcObject = stream;\n      });\n\n    return () => {\n      ws.current.close();\n    };\n  }, []);\n\n  const startPeer = async (initiator = true, remoteOffer = null) => {\n    pc.current = new RTCPeerConnection();\n\n    pc.current.onicecandidate = (e) => {\n      if (e.candidate) {\n        ws.current.send(JSON.stringify({ type: 'candidate', candidate: e.candidate }));\n      }\n    };\n\n    pc.current.ontrack = (e) => {\n      remoteVideo.current.srcObject = e.streams[0];\n    };\n\n    const stream = localVideo.current.srcObject;\n    stream.getTracks().forEach(track => pc.current.addTrack(track, stream));\n\n    if (initiator) {\n      const offer = await pc.current.createOffer();\n      await pc.current.setLocalDescription(offer);\n      ws.current.send(JSON.stringify({ type: 'offer', offer }));\n    } else {\n      await pc.current.setRemoteDescription(remoteOffer);\n      const answer = await pc.current.createAnswer();\n      await pc.current.setLocalDescription(answer);\n      ws.current.send(JSON.stringify({ type: 'answer', answer }));\n    }\n  };\n\n  const sendMessage = () => {\n    if (input.trim() !== '') {\n      ws.current.send(JSON.stringify({ type: 'text', text: input }));\n      setMessages((prev) => [...prev, `You: ${input}`]);\n      setInput('');\n    }\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter') sendMessage();\n  };\n\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n      <div style={{ display: 'flex', gap: '10px', margin: '20px' }}>\n        <video ref={localVideo} autoPlay muted style={{ width: '300px', height: '200px', background: 'black' }} />\n        <video ref={remoteVideo} autoPlay style={{ width: '300px', height: '200px', background: 'black' }} />\n      </div>\n\n      <div style={{ width: '400px', height: '200px', overflowY: 'auto', border: '1px solid #ccc', marginBottom: '10px', padding: '10px' }}>\n        {messages.map((msg, idx) => <div key={idx}>{msg}</div>)}\n      </div>\n\n      <div>\n        <input\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          onKeyPress={handleKeyPress}\n          placeholder=\"Type a message...\"\n          style={{ padding: '10px', width: '300px' }}\n        />\n        <button onClick={sendMessage} style={{ padding: '10px' }}>Send</button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}